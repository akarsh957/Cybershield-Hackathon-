:root {
    --bg-color: #1a1a2e;
    --panel-bg: #16213e;
    --border-color: #0f3460;
    --text-color: #e94560;
    --subtext-color: #c5c6c7;
    --accent-color: #16c79a;
    --operator-color: #53a8b6;
    --subject-color: #e94560;
}

body, html {
    margin: 0; padding: 0; width: 100%; height: 100%;
    background-color: var(--bg-color); color: var(--subtext-color);
    font-family: 'Roboto Mono', monospace; overflow: hidden;
    display: flex; flex-direction: column;
}

/* --- Modal Styles --- */
#start-modal-backdrop {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background-color: rgba(0,0,0,0.8); backdrop-filter: blur(10px);
    z-index: 2000; display: flex; justify-content: center; align-items: center;
}
#start-modal {
    background-color: var(--panel-bg); border: 1px solid var(--border-color);
    border-radius: 10px; padding: 30px; text-align: center;
    box-shadow: 0 0 30px rgba(0,0,0,0.6); width: 400px;
}
#start-modal h2 {
    font-family: 'Teko', sans-serif; font-size: 2.5em;
    color: var(--text-color); margin: 0 0 15px 0;
}
#start-modal p { font-size: 1em; margin-bottom: 20px; }
.form-group { margin-bottom: 15px; text-align: left; }
.form-group label { display: block; margin-bottom: 5px; font-weight: bold; }
.form-group input {
    width: 100%; padding: 10px; border-radius: 5px; border: 1px solid var(--border-color);
    background-color: var(--bg-color); color: white; font-size: 1.1em;
}
#start-tracing-btn {
    width: 100%; padding: 12px; font-size: 1.2em; font-weight: bold;
    background-color: var(--accent-color); color: var(--bg-color);
    border: none; border-radius: 5px; cursor: pointer; transition: background-color 0.2s;
}
#start-tracing-btn:hover { background-color: #13a883; }
#modal-error { color: var(--text-color); height: 20px; margin-top: 10px; }

header {
    padding: 10px 20px; background-color: var(--panel-bg);
    border-bottom: 2px solid var(--border-color); text-align: center; z-index: 1000;
}
header h1 {
    margin: 0; font-family: 'Teko', sans-serif; font-size: 2.5em;
    color: var(--text-color); letter-spacing: 4px;
}
main { flex-grow: 1; position: relative; }
#map { width: 100%; height: 100%; }

.leaflet-tile-pane {
    filter: brightness(0.6) invert(1) contrast(3) hue-rotate(200deg) saturate(0.3) brightness(0.7);
}

.info-panel {
    position: absolute; top: 20px; background-color: rgba(22, 33, 62, 0.9);
    border: 1px solid var(--border-color); border-radius: 8px;
    padding: 15px; width: 300px; box-shadow: 0 0 20px rgba(0,0,0,0.5);
    backdrop-filter: blur(5px); z-index: 1000;
}
#operator-panel { top: 120px; left: 20px; border-left: 5px solid var(--operator-color); }
#subject-panel { right: 20px; border-left: 5px solid var(--subject-color); }
#status-panel {
    left: 20px;
    border-left: 5px solid orange;
}
#status-panel.listening { border-left-color: var(--accent-color); }
#status-panel.listening #status-text { color: var(--accent-color); font-weight: bold; }

.info-panel h2 {
    margin-top: 0; font-family: 'Teko', sans-serif; font-size: 1.8em;
    letter-spacing: 2px; margin-bottom: 10px;
}
#operator-panel h2 { color: var(--operator-color); }
#subject-panel h2 { color: var(--subject-color); }
#status-panel h2 { color: orange; }
#status-panel.listening h2 { color: var(--accent-color); }

.info-panel p { margin: 5px 0; font-size: 0.9em; }
.info-panel p strong { color: #fff; }

.widget-container {
    position: absolute; bottom: 20px; left: 50%;
    transform: translateX(-50%); display: flex; gap: 20px; z-index: 1000;
}
.widget {
    background-color: rgba(22, 33, 62, 0.9); border: 1px solid var(--border-color);
    border-radius: 8px; padding: 15px 25px; text-align: center;
    box-shadow: 0 0 20px rgba(0,0,0,0.5); backdrop-filter: blur(5px); min-width: 200px;
}
.widget .label {
    font-family: 'Teko', sans-serif; font-size: 1.5em;
    color: var(--accent-color); letter-spacing: 1px;
}
.widget .value {
    font-family: 'Teko', sans-serif; font-size: 2.5em;
    color: #fff; margin-top: 5px;
}
#confidence-score {
    font-size: 1.2em; margin-top: 10px; padding: 5px;
    border-radius: 5px; background-color: var(--border-color);
}
